<!doctype html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Winery:: Carrinho de Compras</title>
    <link th:href="@{/imagens/faviconWinery.png}" rel="shortcut icon" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  </head>
  <style>
    .bodyWinery {
            background-image: url('https://play.hbomax.com/default-3840x2160.png') !important;
            background-size: cover !important;
            background-repeat: no-repeat !important;
            background-attachment: fixed !important;
        }
        .corFundo {
            background: linear-gradient(to bottom, #000000, #000000f0) ;
            
        }
    .fundoDoFormulario {
        background: linear-gradient(to bottom, #000000, #000000f0);
    }
    .produto-imagem {
    width: 170px;
    height: 135px;
    object-fit: cover; /* Isso mantém a proporção e cobre a área especificada */
  }

  .botaoPadrao {
    background: linear-gradient(to bottom, #4F0599, #7A0707);
    border: none;
  }

  </style>

  <body class="bodyWinery">
    <nav class="navbar navbar-expand-lg bg-body-tertiary" style="background-color: transparent !important; margin-right: 15px; margin-left: 15px; padding-top: 20px !important;">
      <div class="container-fluid d-flex justify-content-center">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link text-white" href="">
                Vinhos
              </a>
            </li>
  
            <li class="nav-item">
              <a class="nav-link text-white" href="">
                Vinicolas
              </a>
            </li>
  
            <li class="nav-item">
              <a class="nav-link text-white" href="">
                Espumante
              </a>
            </li>
          </ul>
          
          <a class="navbar-brand" href="/Winery" style="position: absolute; left: 50%; transform: translateX(-50%);">
            <img th:src="@{/imagens/logoWinery250x250new.png}" width="175px" alt="Logo da Winery">
          </a>
    
          <ul class="navbar-nav ml-auto">

            <li class="nav-item ml-auto">
              <a class="nav-link text-white" href="/authentication/login">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-person-fill" viewBox="0 0 16 16">
                  <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                </svg>
                Entrar
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container" id="endereco-logado">
      <div class="row mt-3">
          <div class="col-12 col-md-12">
            <div class="d-flex align-items-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill text-white" viewBox="0 0 16 16">
                  <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                </svg>
                <h4 class="text-white ml-2 ms-4">Endereço de entrega:</h4>
              </div>
          </div>
      </div>
    </div>

    <div class="container" id="divEnderecoLogado">

      <ul class="list-group mb-3" style="background-color: transparent; border: none !important;">
        <li class="list-group-item py-3" style="background-color: #1e1a28; border: none !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important;">
          <div class="row g-3" >
            <div class="col-8 col-md-9 col-lg-6" >
              <small class="text-white" id="ruaLogado">teste</small> <br>
              <small class="text-white" id="bairroLogado">zap</small> <br>
              <small class="text-white" id="cep-cidadeLogado">oi</small> <br>
              <button type="button" class="btn btn-outline-info mt-4" style="padding: 7px !important;" data-bs-target="#exampleModalToggle" data-bs-toggle="modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil"
                     viewBox="0 0 16 16">
                  <path
                          d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
                </svg>
                Alterar endereço
              </button>
            </div>
            <div class="col-4 col-md-3 col-lg-5">
              <div class="form-check d-flex align-items-center">
                <input class="form-check-input me-3" data-valor="12.00" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                <label class="form-check-label text-white mb-0" for="flexRadioDefault1">
                  <b>Entrega Padrão</b> - Até 3 dias úteis
                </label>
                <div class="text-end text-white ms-auto">
                  <small >R$ 12,00</small>
                </div>
              </div>
              <div class="form-check d-flex align-items-center">
                <input class="form-check-input me-3" data-valor="50.00" type="radio" name="flexRadioDefault" id="flexRadioDefault2">
                <label class="form-check-label text-white mb-0" for="flexRadioDefault2">
                  <b>Entrega Expressa</b> - Até 2 dias úteis
                </label>
                <div class="text-end text-white ms-auto">
                  <small >R$ 50,00</small>
                </div>
              </div>
              <div class="form-check d-flex align-items-center">
                <input class="form-check-input me-3" data-valor="55.00" type="radio" name="flexRadioDefault" id="flexRadioDefault3">
                <label class="form-check-label text-white mb-0" for="flexRadioDefault3">
                  <b>Entrega Agendada</b> - Até 20 dias úteis
                </label>
                <div class="text-end text-white ms-auto">
                  <small >R$ 55,00</small>
                </div>
              </div>
            </div>
        </li>
      </ul>
    </div>
    <div class="container" id="endereco-nao-logado">
        <div class="row mt-3">
            <div class="col-12 col-md-12">
              <div class="d-flex align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill text-white" viewBox="0 0 16 16">
                    <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                  </svg>
                  <h4 class="text-white ml-2 ms-4">Simule o frete para seu endereço:</h4>
                </div>
            </div>


            <form class="row g-3">
              <div class="col-auto">
                <label for="inputCep" class="visually-hidden">Inserir CEP</label>
                <input type="text" class="form-control" id="inputCep" placeholder="Inserir CEP" minlength="8" maxlength="8" oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 8)">
              </div>
              <div class="col-auto">
                <button type="button" class="btn btn-primary mb-3 botaoPadrao" id="buscarCepBtn">OK</button>
              </div>
            </form>
        </div>
    </div>

    <div class="container" id="divEndereco">
      <div class="row mt-2">

      </div>
      <ul class="list-group mb-3" style="background-color: transparent; border: none !important;">
        <li class="list-group-item py-3" style="background-color: #1e1a28; border: none !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important;">
          <div class="row g-3" >
            <div class="col-8 col-md-9 col-lg-6">
              <small class="text-white" id="rua"></small> <br>
              <small class="text-white" id="bairro"></small> <br>
              <small class="text-white" id="cep-cidade"></small> <br>
            </div> 
            <div class="col-4 col-md-3 col-lg-5">
              <div class="form-check d-flex align-items-center">
                <input class="form-check-input me-3" data-valor="12.00" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                <label class="form-check-label text-white mb-0" for="flexRadioDefault1">
                  <b>Entrega Padrão</b> - Até 3 dias úteis
                </label>
                <div class="text-end text-white ms-auto">
                  <small >R$ 12,00</small>
                </div>
              </div>
              <div class="form-check d-flex align-items-center">
                <input class="form-check-input me-3" data-valor="50.00" type="radio" name="flexRadioDefault" id="flexRadioDefault2">
                <label class="form-check-label text-white mb-0" for="flexRadioDefault2">
                  <b>Entrega Expressa</b> - Até 2 dias úteis
                </label>
                <div class="text-end text-white ms-auto">
                  <small >R$ 50,00</small>
                </div>
              </div>
              <div class="form-check d-flex align-items-center">
                <input class="form-check-input me-3" data-valor="55.00" type="radio" name="flexRadioDefault" id="flexRadioDefault3">
                <label class="form-check-label text-white mb-0" for="flexRadioDefault3">
                  <b>Entrega Agendada</b> - Até 20 dias úteis
                </label>
                <div class="text-end text-white ms-auto">
                  <small >R$ 55,00</small>
                </div>
              </div>
            </div>
        </li>
      </ul>
    </div>
  
    <div class="container">
        <div class="row mt-2">
            <div class="col-12 col-md-12">
              <div class="d-flex align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-basket3-fill text-white" viewBox="0 0 16 16">
                    <path d="M5.757 1.071a.5.5 0 0 1 .172.686L3.383 6h9.234L10.07 1.757a.5.5 0 1 1 .858-.514L13.783 6H15.5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H.5a.5.5 0 0 1-.5-.5v-1A.5.5 0 0 1 .5 6h1.717L5.07 1.243a.5.5 0 0 1 .686-.172zM2.468 15.426.943 9h14.114l-1.525 6.426a.75.75 0 0 1-.729.574H3.197a.75.75 0 0 1-.730-.574z"/>
                </svg>
                <h4 class="text-white ml-2 ms-4">Produto e Serviço</h4>
              </div>
            </div>
        <hr class="text-white">
        <ul class="list-group mb-3" style="background-color: transparent;" id="carrinho-lista">
        </ul>
      </div>
    </div>

    <div class="modal fade" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel" tabindex="-1">
      <div class="modal-dialog modal-xl modal-dialog-centered" >
        <div class="modal-content" style="background-color: #2c263a; border: none !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important;">
          <div class="modal-header">
            <div class="col-10 col-md-10">
              <div class="d-flex align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill text-white" viewBox="0 0 16 16">
                    <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                  </svg>
                  <h4 class="text-white ml-2 ms-4">Selecione o Endereço</h4>
                </div>
            </div>
            <button type="button" class="btn-close p-3" data-bs-dismiss="modal" aria-label="Close" style="color: white !important;"></button>
          </div>
          <div class="modal-body">
            <div class="container">
              <div class="row">
                <div class="col-4">
                  <div class="card-body p-3" style="background-color: #1e1a28; border: 1px !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important; border-radius: 14px;">
                    <div class="d-flex justify-content-between">

                    </div>
                    <hr class="text-white">
                    <h6 class="text-white">Rua Selma Kurtz 21</h6>
                    <h6 class="text-white">Complemento</h6>
                    <h6 class="text-white">Jardim Maria Luiza</h6>
                    <h6 class="text-white">04434010</h6>
                    <h6 class="text-white">São Paulo - SP </h6>
                    <div class="d-flex justify-content-between">
                        <div class="form-check">
                            <input class="form-check-input" type="radio">

                            <label class="form-check-label text-white">
                                Definir como padrão
                            </label>
                        </div>
                    </div>
                  </div>
                </div>

                <div class="col-4">
                  <div class="card-body p-3" style="background-color: #1e1a28; border: 1px !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important; border-radius: 14px;">
                    <div class="d-flex justify-content-between">

                    </div>
                    <hr class="text-white">
                    <h6 class="text-white">Rua Selma Kurtz 21</h6>
                    <h6 class="text-white">Complemento</h6>
                    <h6 class="text-white">Jardim Maria Luiza</h6>
                    <h6 class="text-white">04434010</h6>
                    <h6 class="text-white">São Paulo - SP </h6>
                    <div class="d-flex justify-content-between">
                        <div class="form-check">
                            <input class="form-check-input" type="radio">

                            <label class="form-check-label text-white">
                                Definir como padrão
                            </label>
                        </div>
                    </div>
                  </div>
                </div>

                <div class="col-4">
                  <div class="card-body p-3" style="background-color: #1e1a28; border: 1px !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important; border-radius: 14px;">
                    <div class="d-flex justify-content-between">

                    </div>
                    <hr class="text-white">
                    <h6 class="text-white">Rua Selma Kurtz 21</h6>
                    <h6 class="text-white">Complemento</h6>
                    <h6 class="text-white">Jardim Maria Luiza</h6>
                    <h6 class="text-white">04434010</h6>
                    <h6 class="text-white">São Paulo - SP </h6>
                    <div class="d-flex justify-content-between">
                        <div class="form-check">
                            <input class="form-check-input" type="radio">

                            <label class="form-check-label text-white">
                                Definir como padrão
                            </label>
                        </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary botaoPadrao" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal">Novo Endereço</button>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
      <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content" style="background-color: #2c263a; border: none !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important;">
          <div class="modal-header">
            <div class="col-10 col-md-10">
              <div class="d-flex align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill text-white" viewBox="0 0 16 16">
                    <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                  </svg>
                  <h4 class="text-white ml-2 ms-4">Novo Endereço</h4>
                </div>
            </div>
            <button type="button" class="btn-close p-3" data-bs-dismiss="modal" aria-label="Close" style="color: white !important;"></button>
          </div>
          <div class="modal-body">
            <form class="row g-3">
              <div class="col-6">
                  <label for="" class="form-label text-white">Logradouro</label>
                  <input type="text" class="form-control" id="inputLogradouro" >
                </div>
                <div class="col-2">
                    <label for="" class="form-label text-white">Numero</label>
                    <input type="text" class="form-control" id="inputNumero">
                  </div>
                <div class="col-4">
                    <label for="" class="form-label text-white">Complemento</label>
                    <input type="text" class="form-control" id="inputComplemento">
                  </div>
                <div class="col-md-4">
                    <label for="" class="form-label text-white">Bairro</label>
                    <input type="text" class="form-control" id="inputBairro">
                  </div>
                <div class="col-md-3">
                    <label for="" class="form-label text-white">CEP</label>
                    <input type="text" class="form-control" id="inputCep" placeholder="Somente números" minlength="8" maxlength="8">
                </div>
                <div class="col-md-1">
                  <label for="" class="form-label text-white">UF</label>
                  <input type="text" class="form-control" id="inputUf" maxlength="2">
                </div>
                <div class="col-md-4">
                  <label for="" class="form-label text-white">Cidade</label>
                  <input type="text" class="form-control" id="inputCidade">
                </div>
                <div class="text-center" >
                <button class="btn btn-primary botaoPadrao" style="width: 300px !important;">Cadastrar Novo Endereço</button>
              </div>
          </form>
          </div>
          <!-- <div class="modal-footer">
            <button class="btn btn-primary" data-bs-target="#exampleModalToggle" data-bs-toggle="modal">Back to first</button>
          </div> -->
        </div>
      </div>
    </div>


    <!-- Remove the container if you want to extend the Footer to full width. -->
<div class="bg-body-tertiary " style="background-color: transparent !important; margin-top: 100px;">
    <!-- Footer -->
    <footer class="text-center text-lg-start text-white" style="background-color: transparent !important;">
      <!-- Grid container -->
      <div class="container p-4 pb-0">
        <!-- Section: Links -->
        <section class="">
          <!--Grid row-->
          <div class="row">
            <!--Grid column-->
            <div class="col-lg-4 col-md-6 mb-4 mb-md-0">
                <img th:src="@{/imagens/logoWinery250x250new.png}" width="150px" alt="Logo da Winery">
  
              <p>
                Alguma dúvida? A gente ajuda você! <br>
                Horario de Atendimento: <br>
                De segunda a sexta-feira de 08h as 18h. Exceto feriados.
              </p>
            </div>
            <!--Grid column-->
  
            <!--Grid column-->
            <div class="col-lg-2 col-md-6 mb-4 mb-md-0">
              <h5 class="text-white">Sobre a Winery</h5>
  
              <ul class="list-unstyled mb-0">
                <li>
                  <a href="https://github.com/anaguimaraess/Winery" class="text-white" style="text-decoration: none;">GitHub</a>
                </li>
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Sobre Nós</a>
                </li>
                
              </ul>
            </div>
            <!--Grid column-->
  
            <!--Grid column-->
            <div class="col-lg-2 col-md-6 mb-4 mb-md-0">
              <h5 class="text-white">Suporte</h5>
  
              <ul class="list-unstyled mb-0">
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Política de Frete</a>
                </li>
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Política de Privacidade</a>
                </li>
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Termos de Condições</a>
                </li>
                
              </ul>
            </div>
            <!--Grid column-->
  
            <!--Grid column-->
            <div class="col-lg-2 col-md-6 mb-4 mb-md-0">
              <h5 class="text-white">Categorias</h5>
  
              <ul class="list-unstyled mb-0">
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Lançamentos</a>
                </li>
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Vinho Tinto</a>
                </li>
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Vinho Branco</a>
                </li>
                <li>
                  <a href="#!" class="text-white" style="text-decoration: none;">Promoções</a>
                </li>
              </ul>
            </div>
            <!--Grid column-->
  
            <!--Grid column-->
            <div class="col-lg-2 col-md-6 mb-4 mb-md-0">
              <h5 class="text-white">Formas de Pagamento</h5>
  
              <ul class="list-unstyled mb-0">
                <!-- <img src="../static/imagens/formaPagamento.webp"  width="200px" alt=""> -->
              </ul>
            </div>
            <!--Grid column-->
          </div>
          <!--Grid row-->
        </section>
        <!-- Section: Links -->
  
        <hr class="mb-4" />
  
        <!-- Section: CTA -->
        <section class="text-center">
          <img src="https://static.kabum.com.br/conteudo/temas/001/imagens/rodape/selo_empresabuscape_horizontal.png" width="148" height="30" alt="Empresa reconhecida buscapé" loading="lazy" class="sc-kpKSZj bigULn">
            <a href="https://transparencyreport.google.com/safe-browsing/search?url=kabum.com.br&amp;hl=pt-PT" target="_blank" rel="noreferrer" class="sc-lfYzqA kxaHhl" style="margin-left: 30px;">
            <img src="https://static.kabum.com.br/conteudo/temas/001/imagens/rodape/selo-google-site-seguro.png" alt="GOOGLE SITE SEGURO" width="130" height="46" loading="lazy" class="sc-kpKSZj bigULn"  style="margin-left: 30px;"></a>
            <img src="https://static.kabum.com.br/conteudo/temas/001/imagens/rodape/selo_ebit_kabum_horizontal.png" width="150" height="36" alt="Ebit diamante excelente" loading="lazy" class="sc-kpKSZj bigULn"  style="margin-left: 30px;"></a>
            <a id="seloEconfy" href="https://www.compreconfie.com.br/103388" target="_blank" rel="noreferrer" class="sc-lfYzqA kxaHhl"  style="margin-left: 30px;">
            <img class="sc-kpKSZj bigULn compreConfieImg" src="https://selo.compreconfie.com.br/reputation/103388.png" width="57" height="60" alt="Compre e confie" loading="lazy"  style="margin-left: 30px;"></a>
            <img src="https://static.kabum.com.br/conteudo/temas/001/imagens/rodape/selo-ra.png" height="60" alt="Empresa campeã prêmio reclame aqui 2022" loading="lazy" class="sc-kpKSZj bigULn"  style="margin-left: 30px;"> 
        </section>
        <!-- Section: CTA -->
  
        <hr class="mb-4" />

        <!-- Section: Social media -->
      </div>
      <!-- Grid container -->
  
      <!-- Copyright -->
      <div
           class="text-center p-3"
           style="background-color: transparent !important;"
           >
        © 2023 Copyright por Winery
        
      </div>
      <!-- Copyright -->
    </footer>
    <!-- Footer -->
  </div>
  <!-- End of .container -->

  <script>
      document.addEventListener("DOMContentLoaded", () => {
  hideEnderecoBox(); // Chama a função para ocultar o divEndereco inicialmente
  addEventListeners();
  // updateFrete(); // Atualiza o frete quando a página é carregada
});

  let valorFrete = 0;

  const updateFrete = () => {
    valorFrete = 0;

  const botoesRadio = document.querySelectorAll('input[type="radio"]');


  botoesRadio.forEach((radio) => {
    if (radio.checked) {
      valorFrete = parseFloat(radio.getAttribute('data-valor'));
      console.log(valorFrete)
    }
  });



  document.getElementById("valor-frete").textContent = `R$ ${valorFrete.toFixed(2)}`;

  const carrinho = JSON.parse(localStorage.getItem('carrinho'));
  var valorTotalCarrinho = calcularValorTotalCarrinho(carrinho);
  exibirCarrinho();
};



const botoesRadio = document.querySelectorAll('input[type="radio"]');
document.querySelectorAll('input[type="radio"]').forEach((radio) => {
    radio.addEventListener("change", updateFrete);

  });

    function calcularValorTotalCarrinho(carrinho) {
      let total = 0;
  
      carrinho.forEach((item) => {
        total += item.quantidade * parseFloat(item.preco);
      });
       total = valorFrete + total;
       console.log("sadklaskfsal aa ", total)

      return total;
    }
  
    function adicionarQuantidade(index) {
    const carrinho = JSON.parse(localStorage.getItem('carrinho'));
    const item = carrinho[index];

    if (item.quantidade < item.estoque) {
      item.quantidade++;
    } else {
      alert('Quantidade no carrinho não pode ser maior do que o estoque disponível.');
    }

    localStorage.setItem('carrinho', JSON.stringify(carrinho));
    exibirCarrinho();
  }

  
    function diminuirQuantidade(index) {
      const carrinho = JSON.parse(localStorage.getItem('carrinho'));
      if (carrinho[index].quantidade > 1) {
        carrinho[index].quantidade--;
        localStorage.setItem('carrinho', JSON.stringify(carrinho));
        exibirCarrinho();
      }
    }
  
    function removerItem(index) {
      const carrinho = JSON.parse(localStorage.getItem('carrinho'));
      carrinho.splice(index, 1);
      localStorage.setItem('carrinho', JSON.stringify(carrinho));
      exibirCarrinho();
    }
  
    function adicionarManipuladoresEventos() {
      const carrinho = JSON.parse(localStorage.getItem('carrinho'));
  
      if (carrinho && carrinho.length > 0) {
        carrinho.forEach((item, index) => {
          document
            .getElementById(`aumentar-quantidade-${index}`)
            .addEventListener('click', () => adicionarQuantidade(index));
          document
            .getElementById(`diminuir-quantidade-${index}`)
            .addEventListener('click', () => diminuirQuantidade(index));
          document
            .getElementById(`remover-item-${index}`)
            .addEventListener('click', () => removerItem(index));
        });
      }
    }
  
    function exibirCarrinho() {
      const carrinho = JSON.parse(localStorage.getItem('carrinho'));
      const carrinhoLista = document.getElementById('carrinho-lista');
  
      carrinhoLista.innerHTML = '';
  
      if (carrinho && carrinho.length > 0) {
        carrinho.forEach((item, index) => {
          const valorItem = parseFloat(item.preco);
  
          const itemHTML = `
            <li class="list-group-item py-3 mb-3" style="background-color: #1e1a28; border: none !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important;">
              <div class="row g-3">
                <div class="col-4 col-md-3 col-lg-2">
                <a href="#">
                  <img src="${item.imagemPrincipal}" class="produto-imagem" alt="">
                </a>
              </div>

                <div class="col-8 col-md-9 col-lg-7 col-xl-8 text-left align-self-center">
                  <h4><b><a href="#" class="text-decoration-none text-danger">${item.nome}</a></b></h4>
                  <small class="text-white">${item.descricao}</small>
                </div>
                <div class="col-6 offset-6 col-sm-6 offset-sm-6 col-md-4 offset-md-8 col-lg-3 offset-lg-0 col-xl-2 align-self-center mt-3">
                  <div class="input-group">
                    <button type="button" class="btn btn-outline-dark btn-sm" id="aumentar-quantidade-${index}">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-short text-white" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
                      </svg>
                    </button>
                    <input type="text" class="form-control text-center border-dark" value="${item.quantidade}" readonly>
                    <button type="button" class="btn btn-outline-dark btn-sm" id="diminuir-quantidade-${index}">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-short text-white" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z"/>
                      </svg>
                    </button>
                    <button type="button" class="btn btn-outline-danger border-dark btn-sm" id="remover-item-${index}">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash text-white" viewBox="0 0 16 16">
                        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"/>
                        <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"/>
                      </svg>
                    </button>
                  </div>
                  <div class="text-right mt-2">
                    <b><small class="text-white">Valor Item: </small></b> <small class="text-white">R$ ${valorItem.toFixed(2)}</small>
                  </div>
                </div>
              </div>
            </li>
          `;
  
          carrinhoLista.innerHTML += itemHTML;
        });
  
        let valorTotalCarrinho =  calcularValorTotalCarrinho(carrinho);
        carrinhoLista.innerHTML += `
          <li class="list-group-item py-3" style="background-color: #1e1a28; border: none !important; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5) !important;">
            <div class="text-end">
              <h4 class="text-white mb-3">Valor Total: R$ ${valorTotalCarrinho.toFixed(2)}</h4>
              <h5 id="valor-frete" class="text-white mb-3">Valor Frete: R$ ${valorFrete.toFixed(2)}</h5>
              <a href="/Winery" class="btn btn-outline-success btn-lg">Continuar Comprando</a>
              <button class="btn btn-danger btn-lg botaoPadrao">Ir para Pagamento</button>
            </div>
          </li>
        `;

        adicionarManipuladoresEventos();
      } else {
        carrinhoLista.innerHTML = '<div class="text-center p-3"><h2 style="color: white;">Não há produtos no carrinho.</h2></div>';
      }
    }
  
    // Chame a função para exibir o carrinho
    exibirCarrinho();
    adicionarManipuladoresEventos();

//frete


  const addEventListeners = () => {
    document.getElementById("buscarCepBtn").addEventListener("click", handleCEPSubmit);
    document.querySelectorAll('input[type="radio"]').forEach((radio) => {
    radio.addEventListener("change", updateFrete);
  });
  };



  const hideEnderecoBox = () => {
    const enderecoDiv = document.getElementById("divEndereco");
    enderecoDiv.style.display = "none"; // Oculta o divEndereco
  };

  const showEnderecoBox = () => {
    const enderecoDiv = document.getElementById("divEndereco");
    enderecoDiv.style.display = "block"; // Exibe o divEndereco
  };

  const handleCEPSubmit = () => {
    const inputCep = document.getElementById("inputCep").value;
    const rua = document.getElementById("rua");
    const bairro = document.getElementById("bairro");
    const cepCidade = document.getElementById("cep-cidade");

    if (inputCep.length >= 8) {
      fetchAddress(inputCep, rua, bairro, cepCidade);
      showEnderecoBox(); // Exibe o divEndereco após o CEP ser pesquisado
    } else {
      alert("CEP inválido. Insira um CEP válido.");
    }
  };

  const fetchAddress = (cep, rua, bairro, cepCidade) => {
    fetch(`https://viacep.com.br/ws/${cep}/json/`)
      .then((response) => response.json())
      .then((data) => {
        if (data.erro) {
          alert("CEP não encontrado!");
        } else {
          const endereco = data.logradouro;
          const bairroText = data.bairro;
          const cepCidadeText = `CEP ${data.cep} - ${data.localidade}, ${data.uf}`;
          rua.textContent = endereco;
          bairro.textContent = bairroText;
          cepCidade.textContent = cepCidadeText;
        }
      })
      .catch(() => {
        alert("Erro ao buscar o CEP!");
      });
  };
  function isSessionActive(callback) {
  fetch('/verificar-sessao')
    .then(response => response.json())
    .then(data => {
      callback(data); // Chamar a função de callback com o resultado
    })
    .catch(error => {
      console.error("Erro ao verificar a sessão:", error);
      callback(false); // Tratar erros como sessão inativa
    });
}

isSessionActive(function(sessionActive) {
  const enderecoLogado = document.getElementById('divEnderecoLogado');
  const enderecoNaoLogado = document.getElementById('divEndereco');
  const tituloNaoLogado = document.getElementById('endereco-nao-logado');
  const tituloLogado = document.getElementById('endereco-logado');

  if (sessionActive) {
    enderecoLogado.style.display = 'block';
    enderecoNaoLogado.style.display = 'none';
    tituloNaoLogado.style.display = 'none';
    tituloLogado.style.display = 'block';

  } else {
    enderecoLogado.style.display = 'none';
    tituloNaoLogado.style.display = 'block';
    tituloLogado.style.display = 'none';

  }
});







  </script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  </body>
  </html>
  